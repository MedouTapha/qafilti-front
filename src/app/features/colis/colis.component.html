<div class="flex justify-content-between align-items-center mb-3">
  <h2 class="m-0">Colis</h2>
  <div class="flex gap-2">
    <input pInputText [(ngModel)]="globalFilter" placeholder="Rechercher..." />
    <button pButton label="Nouveau" (click)="openNew()"></button>
  </div>
</div>

<p-table [value]="colis()" [paginator]="true" [rows]="10" [globalFilterFields]="['code','expediteur','destinataire','statut']" [filters]="{ 'global': { value: globalFilter, matchMode: 'contains' } }">
  <ng-template pTemplate="header">
    <tr><th>Code</th><th>Expéditeur</th><th>Destinataire</th><th>Poids (kg)</th><th>Tarif</th><th>Statut</th><th>Actions</th></tr>
  </ng-template>
  <ng-template pTemplate="body" let-c>
    <tr>
      <td>{{ c.code }}</td>
      <td>{{ c.expediteur }}</td>
      <td>{{ c.destinataire }}</td>
      <td>{{ c.poids }}</td>
      <td>{{ c.tarif }} €</td>
      <td><p-tag [value]="c.statut" [severity]="c.statut==='Livré' ? 'success' : 'warning'"/></td>
      <td class="flex gap-2">
        <button pButton icon="pi pi-pencil" (click)="edit(c)"></button>
        <button pButton icon="pi pi-check" *ngIf="c.statut!=='Livré'" (click)="markDelivered(c)" severity="success" tooltip="Marquer livré"></button>
        <button pButton icon="pi pi-times" (click)="remove(c)" severity="danger"></button>
      </td>
    </tr>
  </ng-template>
</p-table>

<p-dialog [(visible)]="dialog" header="Colis" [modal]="true" [style]="{width:'420px'}">
  <div class="flex flex-column gap-2">
    <input pInputText placeholder="Expéditeur" [(ngModel)]="form.expediteur" [style]="{width:'100%'}" />
    <input pInputText placeholder="Destinataire" [(ngModel)]="form.destinataire" [style]="{width:'100%'}" />
    <p-inputNumber placeholder="Poids (kg)" [(ngModel)]="form.poids" [style]="{width:'100%'}"></p-inputNumber>
    <p-inputNumber placeholder="Tarif (€)" [(ngModel)]="form.tarif" [style]="{width:'100%'}"></p-inputNumber>
    <p-select [options]="statuts" optionLabel="label" optionValue="value" [(ngModel)]="form.statut" [style]="{width:'100%'}"></p-select>
  </div>
  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="dialog=false" text></button>
    <button pButton label="Enregistrer" (click)="save()"></button>
  </ng-template>
</p-dialog>
