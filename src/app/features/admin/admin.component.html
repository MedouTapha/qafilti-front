<p-tabs [value]="0">
  <p-tablist>
    <p-tab [value]="0" label="Bus"></p-tab>
    <p-tab [value]="1" label="Villes"></p-tab>
    <p-tab [value]="2" label="Trips"></p-tab>
    <p-tab [value]="3" label="Trajets"></p-tab>
    <p-tab [value]="4" label="Véhicules"></p-tab>
    <p-tab [value]="5" label="Tarifs"></p-tab>
  </p-tablist>
  <p-tabpanels>
    <!-- Bus Tab -->
    <p-tabpanel [value]="0">
      <div class="flex justify-content-between align-items-center mb-2">
        <h3 class="m-0">Bus</h3>
        <button pButton label="Ajouter" (click)="openBus()"></button>
      </div>
      <p-table [value]="buses()">
        <ng-template pTemplate="header">
          <tr><th>ID</th><th>Immatriculation</th><th>Statut</th><th>Capacité</th><th>Actions</th></tr>
        </ng-template>
        <ng-template pTemplate="body" let-b>
          <tr>
            <td>{{ b.id }}</td>
            <td>{{ b.license_plate }}</td>
            <td>{{ b.status }}</td>
            <td>{{ b.capacity }}</td>
            <td>
              <button pButton icon="pi pi-pencil" (click)="editBus(b)"></button>
              <button pButton icon="pi pi-times" severity="danger" (click)="removeBus(b)"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-tabpanel>

    <!-- Cities Tab -->
    <p-tabpanel [value]="1">
      <div class="flex justify-content-between align-items-center mb-2">
        <h3 class="m-0">Villes</h3>
        <button pButton label="Ajouter" (click)="openCity()"></button>
      </div>
      <p-table [value]="cities()">
        <ng-template pTemplate="header">
          <tr><th>ID</th><th>Nom (FR)</th><th>Nom (AR)</th><th>Actions</th></tr>
        </ng-template>
        <ng-template pTemplate="body" let-c>
          <tr>
            <td>{{ c.id }}</td>
            <td>{{ c.nameFr }}</td>
            <td>{{ c.nameAr }}</td>
            <td>
              <button pButton icon="pi pi-pencil" (click)="editCity(c)"></button>
              <button pButton icon="pi pi-times" severity="danger" (click)="removeCity(c)"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-tabpanel>

    <!-- Trips Tab -->
    <p-tabpanel [value]="2">
      <div class="flex justify-content-between align-items-center mb-2">
        <h3 class="m-0">Trips (Voyages)</h3>
        <button pButton label="Ajouter" (click)="openTrip()"></button>
      </div>
      <p-table [value]="trips()">
        <ng-template pTemplate="header">
          <tr><th>ID</th><th>Date</th><th>Départ</th><th>Arrivée</th><th>Bus</th><th>Heures</th><th>Actions</th></tr>
        </ng-template>
        <ng-template pTemplate="body" let-t>
          <tr>
            <td>{{ t.tripId }}</td>
            <td>{{ t.date }}</td>
            <td>{{ t.departureCityName || t.departureCityId }}</td>
            <td>{{ t.arrivalCityName || t.arrivalCityId }}</td>
            <td>{{ t.vehicleId }}</td>
            <td>{{ t.departureTime }} - {{ t.arrivalTime }}</td>
            <td>
              <button pButton icon="pi pi-pencil" (click)="editTrip(t)"></button>
              <button pButton icon="pi pi-times" severity="danger" (click)="removeTrip(t)"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-tabpanel>

    <!-- Trajets Tab -->
    <p-tabpanel [value]="3">
      <div class="flex justify-content-between align-items-center mb-2">
        <h3 class="m-0">Trajets</h3>
        <button pButton label="Ajouter" (click)="openTrajet()"></button>
      </div>
      <p-table [value]="trajets()">
        <ng-template pTemplate="header">
          <tr><th>Code</th><th>Origine</th><th>Destination</th><th>Actions</th></tr>
        </ng-template>
        <ng-template pTemplate="body" let-t>
          <tr>
            <td>{{ t.code }}</td>
            <td>{{ t.origine }}</td>
            <td>{{ t.destination }}</td>
            <td>
              <button pButton icon="pi pi-pencil" (click)="editTrajet(t)"></button>
              <button pButton icon="pi pi-times" severity="danger" (click)="removeTrajet(t)"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-tabpanel>
    <p-tabpanel [value]="4">
      <div class="flex justify-content-between align-items-center mb-2">
        <h3 class="m-0">Véhicules</h3>
        <button pButton label="Ajouter" (click)="openVehicule()"></button>
      </div>
      <p-table [value]="vehicules()">
        <ng-template pTemplate="header">
          <tr><th>Matricule</th><th>Modèle</th><th>Capacité</th><th>Actions</th></tr>
        </ng-template>
        <ng-template pTemplate="body" let-v>
          <tr>
            <td>{{ v.matricule }}</td>
            <td>{{ v.modele }}</td>
            <td>{{ v.capacite }}</td>
            <td>
              <button pButton icon="pi pi-pencil" (click)="editVehicule(v)"></button>
              <button pButton icon="pi pi-times" severity="danger" (click)="removeVehicule(v)"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-tabpanel>
    <p-tabpanel [value]="5">
      <div class="flex justify-content-between align-items-center mb-2">
        <h3 class="m-0">Tarifs</h3>
        <button pButton label="Ajouter" (click)="openTarif()"></button>
      </div>
      <p-table [value]="tarifs()">
        <ng-template pTemplate="header">
          <tr><th>Trajet</th><th>Prix (€)</th><th>Actions</th></tr>
        </ng-template>
        <ng-template pTemplate="body" let-f>
          <tr>
            <td>{{ f.trajet }}</td>
            <td>{{ f.prix }}</td>
            <td>
              <button pButton icon="pi pi-pencil" (click)="editTarif(f)"></button>
              <button pButton icon="pi pi-times" severity="danger" (click)="removeTarif(f)"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-tabpanel>
  </p-tabpanels>
</p-tabs>

<!-- Dialogs -->
<p-dialog [(visible)]="trajetDialog" header="Trajet" [modal]="true" [style]="{width:'420px'}">
  <div class="flex flex-column gap-2">
    <input pInputText placeholder="Code" [(ngModel)]="trajetForm.code" [style]="{width:'100%'}" />
    <input pInputText placeholder="Origine" [(ngModel)]="trajetForm.origine" [style]="{width:'100%'}" />
    <input pInputText placeholder="Destination" [(ngModel)]="trajetForm.destination" [style]="{width:'100%'}" />
  </div>
  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="trajetDialog=false" text></button>
    <button pButton label="Enregistrer" (click)="saveTrajet()"></button>
  </ng-template>
</p-dialog>

<p-dialog [(visible)]="vehiculeDialog" header="Véhicule" [modal]="true" [style]="{width:'420px'}">
  <div class="flex flex-column gap-2">
    <input pInputText placeholder="Matricule" [(ngModel)]="vehiculeForm.matricule" [style]="{width:'100%'}" />
    <input pInputText placeholder="Modèle" [(ngModel)]="vehiculeForm.modele" [style]="{width:'100%'}" />
    <input pInputText placeholder="Capacité" [(ngModel)]="vehiculeForm.capacite" [style]="{width:'100%'}" />
  </div>
  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="vehiculeDialog=false" text></button>
    <button pButton label="Enregistrer" (click)="saveVehicule()"></button>
  </ng-template>
</p-dialog>

<p-dialog [(visible)]="tarifDialog" header="Tarif" [modal]="true" [style]="{width:'420px'}">
  <div class="flex flex-column gap-2">
    <input pInputText placeholder="Trajet" [(ngModel)]="tarifForm.trajet" [style]="{width:'100%'}" />
    <input pInputText placeholder="Prix (€)" [(ngModel)]="tarifForm.prix" [style]="{width:'100%'}" />
  </div>
  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="tarifDialog=false" text></button>
    <button pButton label="Enregistrer" (click)="saveTarif()"></button>
  </ng-template>
</p-dialog>

<!-- Bus Dialog -->
<p-dialog [(visible)]="busDialog" header="Bus" [modal]="true" [style]="{width:'420px'}">
  <div class="flex flex-column gap-2">
    <input pInputText placeholder="Plaque d'immatriculation" [(ngModel)]="busForm.license_plate" [style]="{width:'100%'}" />
    <p-select [options]="busStatusOptions" optionLabel="label" optionValue="value" [(ngModel)]="busForm.status" placeholder="Statut" [style]="{width:'100%'}"></p-select>
    <input pInputText placeholder="Capacité" [(ngModel)]="busForm.capacity" type="number" [style]="{width:'100%'}" />
  </div>
  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="busDialog=false" text></button>
    <button pButton label="Enregistrer" (click)="saveBus()"></button>
  </ng-template>
</p-dialog>

<!-- City Dialog -->
<p-dialog [(visible)]="cityDialog" header="Ville" [modal]="true" [style]="{width:'420px'}">
  <div class="flex flex-column gap-2">
    <input pInputText placeholder="Nom en français" [(ngModel)]="cityForm.nameFr" [style]="{width:'100%'}" />
    <input pInputText placeholder="Nom en arabe" [(ngModel)]="cityForm.nameAr" dir="rtl" [style]="{width:'100%'}" />
  </div>
  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="cityDialog=false" text></button>
    <button pButton label="Enregistrer" (click)="saveCity()"></button>
  </ng-template>
</p-dialog>

<!-- Trip Dialog -->
<p-dialog [(visible)]="tripDialog" header="Trip (Voyage)" [modal]="true" [style]="{width:'500px'}">
  <div class="flex flex-column gap-2">
    <label>Date</label>
    <input pInputText type="date" [(ngModel)]="tripForm.date" [style]="{width:'100%'}" />

    <label>Ville de départ</label>
    <input pInputText placeholder="ID ville départ" [(ngModel)]="tripForm.departureCityId" [style]="{width:'100%'}" />
    <input pInputText placeholder="Nom (FR)" [(ngModel)]="tripForm.departureCityName" [style]="{width:'100%'}" />

    <label>Ville d'arrivée</label>
    <input pInputText placeholder="ID ville arrivée" [(ngModel)]="tripForm.arrivalCityId" [style]="{width:'100%'}" />
    <input pInputText placeholder="Nom (FR)" [(ngModel)]="tripForm.arrivalCityName" [style]="{width:'100%'}" />

    <label>Bus</label>
    <input pInputText placeholder="ID Bus (ex: B006)" [(ngModel)]="tripForm.vehicleId" [style]="{width:'100%'}" />

    <div class="grid">
      <div class="col-6">
        <label>Heure départ</label>
        <input pInputText type="time" [(ngModel)]="tripForm.departureTime" [style]="{width:'100%'}" />
      </div>
      <div class="col-6">
        <label>Heure arrivée</label>
        <input pInputText type="time" [(ngModel)]="tripForm.arrivalTime" [style]="{width:'100%'}" />
      </div>
    </div>
  </div>
  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="tripDialog=false" text></button>
    <button pButton label="Enregistrer" (click)="saveTrip()"></button>
  </ng-template>
</p-dialog>
